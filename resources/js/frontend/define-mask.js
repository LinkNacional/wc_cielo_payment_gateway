window.addEventListener('DOMContentLoaded', function () {
    // Verify if is checkout page or cart page
    let noLoginCheckout = document.getElementById('lkn_cc_no_login_checkout');

    if (noLoginCheckout && noLoginCheckout.value === 'true') {
        // Credit card
        var formattedcc = new Formatter(document.getElementById('lkn_ccno'), {
            'patterns': [
                // elo
                { '(4011|431274|438935|451416|457393|4576|457631|457632|504175|627780|636297|636368|636369|(6503[1-3])|(6500(3[5-9]|4[0-9]|5[0-1]))|(6504(0[5-9]|1[0-9]|2[0-9]|3[0-9]))|(650(48[5-9]|49[0-9]|50[0-9]|51[1-9]|52[0-9]|53[0-7]))|(6505(4[0-9]|5[0-9]|6[0-9]|7[0-9]|8[0-9]|9[0-8]))|(6507(0[0-9]|1[0-8]))|(6507(2[0-7]))|(650(90[1-9]|91[0-9]|920))|(6516(5[2-9]|6[0-9]|7[0-9]))|(6550(0[0-9]|1[1-9]))|(6550(2[1-9]|3[0-9]|4[0-9]|5[0-8]))|(506(699|77[0-8]|7[1-6][0-9))|(509([0-9][0-9][0-9])))': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // hipercard
                { '^(606282[0-9]{10}([0-9]{3})?)|(3841[0-9]{15})$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // diners
                { '^3(?:0[0-5]|[68][0-9])[0-9]{11}$': '{{9999}} {{999999}} {{9999}}' },
                // discover
                { '^6(?:011|5[0-9]{2})[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // jcb
                { '^(?:2131|1800|35[0-9]{3})[0-9]{11}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // aura
                { '^50[0-9]{14,17}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // amex
                { '^3[47][0-9]{13}$': '{{9999}} {{999999}} {{99999}}' },
                // visa
                { '^4[0-9]{12}(?:[0-9]{3})?$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // mastercard
                { '^5[1-5][0-9]{14}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                { '^2(?:2(?:2[1-9]|[3-9][0-9])|[3-6][0-9][0-9]|7(?:[01][0-9]|20))[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // unknown
                { '*': '{{999999999999999999999999999999}}' }
            ]
        });

        var formattedExpDateCc = new Formatter(document.getElementById('lkn_cc_expdate'), {
            'pattern': '{{99}} / {{9999}}'
        });

        var formattedCvvCc = new Formatter(document.getElementById('lkn_cc_cvc'), {
            'pattern': '{{9999}}'
        });

        // Debit card
        var formatteddc = new Formatter(document.getElementById('lkn_dcno'), {
            'patterns': [
                // elo
                { '(4011|431274|438935|451416|457393|4576|457631|457632|504175|627780|636297|636368|636369|(6503[1-3])|(6500(3[5-9]|4[0-9]|5[0-1]))|(6504(0[5-9]|1[0-9]|2[0-9]|3[0-9]))|(650(48[5-9]|49[0-9]|50[0-9]|51[1-9]|52[0-9]|53[0-7]))|(6505(4[0-9]|5[0-9]|6[0-9]|7[0-9]|8[0-9]|9[0-8]))|(6507(0[0-9]|1[0-8]))|(6507(2[0-7]))|(650(90[1-9]|91[0-9]|920))|(6516(5[2-9]|6[0-9]|7[0-9]))|(6550(0[0-9]|1[1-9]))|(6550(2[1-9]|3[0-9]|4[0-9]|5[0-8]))|(506(699|77[0-8]|7[1-6][0-9))|(509([0-9][0-9][0-9])))': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // hipercard
                { '^(606282[0-9]{10}([0-9]{3})?)|(3841[0-9]{15})$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // diners
                { '^3(?:0[0-5]|[68][0-9])[0-9]{11}$': '{{9999}} {{999999}} {{9999}}' },
                // discover
                { '^6(?:011|5[0-9]{2})[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // jcb
                { '^(?:2131|1800|35[0-9]{3})[0-9]{11}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // aura
                { '^50[0-9]{14,17}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // amex
                { '^3[47][0-9]{13}$': '{{9999}} {{999999}} {{99999}}' },
                // visa
                { '^4[0-9]{12}(?:[0-9]{3})?$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // mastercard
                { '^5[1-5][0-9]{14}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                { '^2(?:2(?:2[1-9]|[3-9][0-9])|[3-6][0-9][0-9]|7(?:[01][0-9]|20))[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                // unknown
                { '*': '{{999999999999999999999999999999}}' }
            ]
        });

        var formattedExpDateDc = new Formatter(document.getElementById('lkn_dc_expdate'), {
            'pattern': '{{99}} / {{9999}}'
        });

        var formattedcvvDc = new Formatter(document.getElementById('lkn_dc_cvc'), {
            'pattern': '{{9999}}'
        });
    } else {
        jQuery('body').on('updated_checkout', function () {
            // Credit card
            var formattedcc = new Formatter(document.getElementById('lkn_ccno'), {
                'patterns': [
                    // elo
                    { '(4011|431274|438935|451416|457393|4576|457631|457632|504175|627780|636297|636368|636369|(6503[1-3])|(6500(3[5-9]|4[0-9]|5[0-1]))|(6504(0[5-9]|1[0-9]|2[0-9]|3[0-9]))|(650(48[5-9]|49[0-9]|50[0-9]|51[1-9]|52[0-9]|53[0-7]))|(6505(4[0-9]|5[0-9]|6[0-9]|7[0-9]|8[0-9]|9[0-8]))|(6507(0[0-9]|1[0-8]))|(6507(2[0-7]))|(650(90[1-9]|91[0-9]|920))|(6516(5[2-9]|6[0-9]|7[0-9]))|(6550(0[0-9]|1[1-9]))|(6550(2[1-9]|3[0-9]|4[0-9]|5[0-8]))|(506(699|77[0-8]|7[1-6][0-9))|(509([0-9][0-9][0-9])))': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // hipercard
                    { '^(606282[0-9]{10}([0-9]{3})?)|(3841[0-9]{15})$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // diners
                    { '^3(?:0[0-5]|[68][0-9])[0-9]{11}$': '{{9999}} {{999999}} {{9999}}' },
                    // discover
                    { '^6(?:011|5[0-9]{2})[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // jcb
                    { '^(?:2131|1800|35[0-9]{3})[0-9]{11}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // aura
                    { '^50[0-9]{14,17}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // amex
                    { '^3[47][0-9]{13}$': '{{9999}} {{999999}} {{99999}}' },
                    // visa
                    { '^4[0-9]{12}(?:[0-9]{3})?$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // mastercard
                    { '^5[1-5][0-9]{14}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    { '^2(?:2(?:2[1-9]|[3-9][0-9])|[3-6][0-9][0-9]|7(?:[01][0-9]|20))[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // unknown
                    { '*': '{{999999999999999999999999999999}}' }
                ]
            });

            var formattedExpDateCc = new Formatter(document.getElementById('lkn_cc_expdate'), {
                'pattern': '{{99}} / {{9999}}'
            });

            var formattedCvvCc = new Formatter(document.getElementById('lkn_cc_cvc'), {
                'pattern': '{{9999}}'
            });

            // Debit card
            var formatteddc = new Formatter(document.getElementById('lkn_dcno'), {
                'patterns': [
                    // elo
                    { '(4011|431274|438935|451416|457393|4576|457631|457632|504175|627780|636297|636368|636369|(6503[1-3])|(6500(3[5-9]|4[0-9]|5[0-1]))|(6504(0[5-9]|1[0-9]|2[0-9]|3[0-9]))|(650(48[5-9]|49[0-9]|50[0-9]|51[1-9]|52[0-9]|53[0-7]))|(6505(4[0-9]|5[0-9]|6[0-9]|7[0-9]|8[0-9]|9[0-8]))|(6507(0[0-9]|1[0-8]))|(6507(2[0-7]))|(650(90[1-9]|91[0-9]|920))|(6516(5[2-9]|6[0-9]|7[0-9]))|(6550(0[0-9]|1[1-9]))|(6550(2[1-9]|3[0-9]|4[0-9]|5[0-8]))|(506(699|77[0-8]|7[1-6][0-9))|(509([0-9][0-9][0-9])))': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // hipercard
                    { '^(606282[0-9]{10}([0-9]{3})?)|(3841[0-9]{15})$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // diners
                    { '^3(?:0[0-5]|[68][0-9])[0-9]{11}$': '{{9999}} {{999999}} {{9999}}' },
                    // discover
                    { '^6(?:011|5[0-9]{2})[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // jcb
                    { '^(?:2131|1800|35[0-9]{3})[0-9]{11}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // aura
                    { '^50[0-9]{14,17}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // amex
                    { '^3[47][0-9]{13}$': '{{9999}} {{999999}} {{99999}}' },
                    // visa
                    { '^4[0-9]{12}(?:[0-9]{3})?$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // mastercard
                    { '^5[1-5][0-9]{14}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    { '^2(?:2(?:2[1-9]|[3-9][0-9])|[3-6][0-9][0-9]|7(?:[01][0-9]|20))[0-9]{12}$': '{{9999}} {{9999}} {{9999}} {{9999}}' },
                    // unknown
                    { '*': '{{999999999999999999999999999999}}' }
                ]
            });

            var formattedExpDateDc = new Formatter(document.getElementById('lkn_dc_expdate'), {
                'pattern': '{{99}} / {{9999}}'
            });

            var formattedcvvDc = new Formatter(document.getElementById('lkn_dc_cvc'), {
                'pattern': '{{9999}}'
            });
        });
    }
});
